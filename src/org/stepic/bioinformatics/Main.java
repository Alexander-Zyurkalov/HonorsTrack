package org.stepic.bioinformatics;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.stream.Collector;
import java.util.stream.Collectors;

import static java.util.stream.Collectors.joining;

public class Main {

    public static void main(String[] args) {

//        String text = "";
//        try (var fileReader = new FileReader("E_coli.txt ");
//             var bufferedReader = new BufferedReader(fileReader)
//        ) {
//            text = bufferedReader.readLine();
//        } catch (IOException e) {
//            e.printStackTrace();
//        }
        var genome = new Genome("CCTGAAGTGCAGCTGCGAGCATCCACTTGCTTTCGTTCTTAGTATATGTGATAGGCAATTGATGGTGCGCGTCTGGAGTGGTGAGTAAGGGAGGATGCTTATGAATAACAGTGTAGACTTGGGTCCTCCAGTCCTTGCGTTTCGTTAGGTGACGTTCATCTTACCGGACTCATTGGCAAGCGCGTTCCGATCTACACCTCCCCCGTAGTGCATCACTACTCCGTGTCGGGCGGGAGCAAAGGAGGAAACCTGGTATTATAGACATTCGTTACCTACCCTCCCACTGGGAACCTGTTCTTACCTGTTATGTATGCGGTTTTGAGTCCACTGATGGCCTTTCTACTGATGAGAGAAAATGGCACCGTGGAAGATACAACCGTTGGAAGCGAGGCTTTCTGGTCTTTACGTGTGGTCTATCGATCAGAAACTTCCTATATCGATCAGAAATCATTGATAACTACTTACTGTATCGATCTATCGATCATATCGATCAGATATCGATCAGAAAGAATTGTATCGATCAGAATCAGAATATTATCGATCAGAAAGAAGTTGTGGCCCAGTCTATCGATCAGAAATCGATCAGAAAATTAGTGGTTAGAATAAGGATCAATGGATCCTTTCTACGTTACTTCTATCGATCAGATATCGATCAGAAAACACCTATCGATCAGATATCGATCAGAAGATCAGAAGGCACTGTCGCACCCAAGTGCTGCTCATGTTTTCGCACGTTATGGCTAGGTTATATCGATCAGAAGCCACCTATCGATCAGAACGTATTATCGATCTATCGATCAGAAACTATCGATCAGAAGAACTGCGGGGGACACGTCGCCGACCCGGGCGCGAGAGAACCCTCTTTATTGTTTATCTATCGATCAGATATCGATCAGAAAATCGATCAGAAGAGCTAAATGTCAACTGCAGATATCGATCAGAACTTCAACGTCATCATATAGCTATAAGGTCCGAGGTCTATCGATCAGAAGAGGTCGATCGTAGGGCGGTGAACCGAGGTCGATCGCGAGGTCGATCGGTCGATCGGTGTCGAGGTCGATTATACCGGATAACGGTCGAGGTCGATCGCGCGTTATTATACCGGATTATACCGGATAACCGGATACCGGATTTATACCGGATAATAGCAGCGTGCTGCCGTCGAGGTCGTTATACCGGATTATACCGGATAATCGCTCGATAACCGAGGTCGATCGTTCGGAAGGTGTGCCACTACCTACGCTCTCATTATACCGGATATCGATCGTTGCAGCGACGAGGTCGATCGCTATAGTTATACCGGATACGGATAACCGGATATCGGGTTATACCGGATACGGATACGATCGACCGAGGTCGATCGTTTTATTTATACCGGATAACCCGAGGTCGATCGTCCGACTTATACCGGATACATGGGAGTAATTGCTGGACAGCTGCTTATACCGGATACGAGGTCGATCGCAGTACGTAATTTTATTTATACTTATACCGGATATAGATACGATTATACCTTATTTATACCGGATATGTCTTATACCGGATAAAATATTCGGAAGTGTGTTATACCGGATAAGGACTTTCTCCTGGTTATTTATACCGGATATCTTTATACCGGATAAGAGTTTCGGCGCGTATCGTTGTAGAAATAGTTTCAACTCATCTCTCACCCCGCTCACCGCAGGGTTCCTTAAGAATCAGTATAATGGGGGCTATATTTAGGTTTAAATGAATGGGGGCTATATCCGGATATGCCGTGTTCAGCGCTTTCTTGTATTCTGAATATGCAATGAAATGGGGGCTATTGGGCTATAGTTACGACAAGCTGACATCTCTCAATGGGGGCTATCAGATATCGGAATGGGGGCTATTCAAGAGGTTATCTTGAGGCGAGTTAGCACACAATGATCCCCTCTACATCCAAATGGGGGCTATCCTAGGTACCTCAAGAGTTGAATTTAATGGGGGCTATATCTAATGGGGGCTATAAGTTCACAATGGGGGCTATTGGCTTGGTCGCACGCATCTAATGGGGGCTATGGGCTATTCAGGAGGGCAATGGGGGCTATCTGATAATGGGGGCTATGACCATTGCAATGGGGGCTATGCTATTCAATTAGTACAATGGGGGCTAATGGGGGCTATGGGGGCTATTTAATGGGGGCTATCGGGGCGAATGGGGGCTATGGGCAATGGGGGCTATAATTTGTACTAGGAAATGGGGGCTATGGGCTATAATGGGAATGGGGGCTAAATGGGGGCTATTCATGCCGTTAGATCGACCCCTGTCTGGTTTGCCGCGTACTCCAGTCCGTATGCTTACTGTGCCTTGAGGATCCGGGGACTTAGTAGGATCCTAACTGCTACCTACTTAGGATGACAGTGAATGAGTCGAGGTCTAGAACGATGGCCAGCCGCGCTTTACTACAGTATGGGCCTTTTGTATTGGCGGTGGCTTAGCAGCACTCGGGGCCTGTTCTCATGCCCAGCAATTCACATGAGTCGATGAACGGACAGCAGTTCCTTATCTGGCAATTTTAGTAATAAAGACCCTTGAACCGCGACAGGCTATGGTCTCGTCAGGCGACGCGTTCTTCGGTAGGTCATTGGTCCACTATGTACAAATTAAGTTAATGGGAAGACGGATAATAGCTTCTAGTCAGGGAAGTCTGTGGATGTCGGTCTTAATCTATACGTACGTGGTGGGAGCAGCCTAGATCTCGGCTCCAGTTGTTTCTTAAGACGCTTTAAAATCTAGGTGACAATGATCCGTTAGACATTGTCAGCCAGGGTTTCTCTATGAGGCTCCGTTACGCTACAGGGATTAGAATGACATCTATAACCAGCATAACAATCCTCTGGCTCAGCCCACGATTAAACCGCGATCGCAATAAAGAACACACCCTGATGAGCAACGCCCTATATCCTTTAATGTTCTCCCCAGTCCAAGGTGTAGGCCAACAAAATGGAGGCTCAAGTGGACAACTGTTCAGCGGCATCGTACTACTCGGCCGTGGAGTGTTCATTCCCTAAATCAGTGAACCGTCGAACCTGACGTCCTAAACTTCGCATTAGTGGTGGTTGCGAGTGCATTTACAAACGGAGACGAGCACGAATTTAACTTCTCGATACAAGGCAATCCATTCGAGTTCGGCTAATTATCAAGCCACCGCGGTTCCATTCCAGGGTGTTGGCTTTATATGGTCGGGGTCAGAGCCAACGGGTTATATCAGCCGGACAATCTCCCTGCGTGCCCGTTAGAAAATGCATCCCGGACTAGCGCTTCTGTGACAACAAACGCATGGTCCGTCGATGGGCTCCAAGAGGACCGCTCAAGGCAGTTATCATCTGCTGGTATGCAGAGATCGACGATTCATAAACTATGACAACCCGTATGTACCACTAGGCTCGAGATGAATACAGTCCATTGAATAAGGGGTTTCGTTACACATTGTGAGAACCGCTAGCTTGTTGCTTTGTACTATCGAGTGGGGCGGTGTCCCGGACCAAGCCAGTCGTTAAGTTCCATCGACATTTGTCCCGAATACTTGTCGGTGCAGAGTTAAACGTTGAAGCTTTAATGGCCCCAGGCACATGCTCTCCACGGGCTATCCAAAAATCATACGGAGCCGTTATTGCAAAAAAATCGCGTGATAACCGAGGCGTTATGCATGAATTGTCCATTTGTAACCGAGGCGTCCTGCTCAGGGTCCCTAACCGAGGCGTGTAGTAACGAAGTTAACCGAGGCGTAGGCGTTCTCCTTAACCGAGGCGTCGTGGATTAACCGAGGCGTTTAGGGACAAGGTAAGCATATTCGTCACCAGAATGGCAGAATGAGTTTCATAACCGAGGCGTTAACCGAGGTAACCGAGGCGTGAACGCACCCTATCTAACTAACCGAGGCGTGGAGTGGTGACTGTACAGGAGTGGTGAAGTAACTCTAACTTCTTCGAACCCGGGTTTCAACAGGATAACCGAGGCGTAGGCGTACGGGTAACCGAGGCGTTTTCAGGGTTTCATAACCGAGGCGTTTCAGTTAATAACCGAGGCGTCGTTAACCGAGGCGTACGGTAACCGATAACCGAGGCGTATTGCGGTAATTAACCGAGGCGTAACCGAGGCGTTAACAGTAACCGAGGCGTCGTAACCGAGGCGTAACCGAGGCGTTTGCGGTTAACCGAGGCGTTAACCGAGGCGTCATAACCGAGGCGTTTCATTATTGCGGTAACGGTAATATTGCGGTAACCCTATTGCGGTAACTTGCGGTAACTTGCTATTGCGGTAACTTATTGCGGTAACGGAGTGGTTATTGCGGTAACTGCTGTATTGCGGTAACTTTCAGAGTGGTGTCACAGGAGTGGTATTGCGGTAACGGTTATTGCGGTAACTTTCAGGACCCGGGTTTCAGTGGTGTACTATTGCGGTAACTATTGCGGTAACAACATAACTATTGCGGTAACACCCTATATTGCGGTAACACAACCCGGGTATTGCGGTAACTTCAATTATTGCGGTAACGGTGTATTTATTGCGGTAACCCCGCAAATCAAGCTGGTGCGGCTGTGACACCTGATCCTCGTATTGCGGTAACGTGGACGCATCACAGATGGCATACGGGACGTAGACAACACGTGACCGCGATGGGATCGCGTCTTCGACCCCGCCTCTTGTGCCATACCCGATTTGTTCGAGGGCGTCGCCTAACCGCATTAGATGCGACTGGCCCCGATTTGTTCGATTTGTTCCCCCCGATTTGTTCCTCCCGATTTGTTCAATTACCTACCCGGTAATTCGCGTATCCCGATTCCCGATTTGTTCCCGATTTGTTCCCCCCGATTCCCGATTTGTTCTTTGTTCATCCCGATTTGTTCGTTGCGGATCTTCTGCGCCCGATTTGTTCACCCTGAGTCGACCCGATTTGTTCTAGACTAGACTATTAGACTATCCCGATTTGTTCTCCCCGATTTGTTCAGTCGCAGACTATGACTATTACCTGACTCTCACCGACTGACTATTACCTGCCCCGCCCGATTTGTTCGATCCCGATTTGTTCGCCGACACATCCCGATTTGTTCGGACCCGATTTGTTCCGACGACTACCCCCCGATTTGTTCGATGCTCGTGCTTATCGACGCCAACCAGACTATTACGACTCCCGATTTCCCGATTTGTTCCCCCGATTTGTTCCTATTACCTGAAACACTAGCGCATGACTATTACCTGCTATTACCTGAGACTATTACCTGAGTTCAGACTATTACCTGCCGCGAATTTCCAAACCGATTGCACATGGACTATTACCTGACCTGACGTGTGTTGCCAGACTATTACCTGTAGACTATTACCTGAGCGTTGTGGACTATTACCTGAGACTATTACCTGCTTACCTCTCATAGACTATTACCTGATTTTCCCGGAGCTAGGGGAAATGACTATTACCTGTAGAAGTGACCACGGAATTGCTTGGTCGGACTGACTATTACCTGGAACGACATGAAACTGGTGATTTCATCATTGGTGAGATAGCCACGGCCCACCGCGGATACAGTTAATGAATGGCGGATACAGTTAAGGACACAGGCGGATACAGTTAGTTGCGGATACAGTTGTCGTATTTTTCTAGAGGCGGATGCGGATACAGTTTTTGCGGATACAGTTGGCCTCTTGGCGGATACAGTTATACAGTTCCTACTCCACTTCTGTTTCGCCGTCCCTATTGTCGCATAGAACCCACTGTCATCACGCGGATACAGTGCGGATACAGTGCGGAGCGGATACAGTTATTCCGCCCAGCCACTAGCGGATACAGTGCGGATACAGTTGGCGGATACAGTTAGTCATGATTCCTGGGCAATCATAGGCGACATGCCCACCTTGGCGGATACAGTTTCTAACATATCGCCGCGACGACAGCGGATACAGTTGTGGCGGATACAGTTTGCGGATACAGTTGGATACAGTTGCAGAGTTTGATGCTGATGCTATCTTGTTCAACGTGATGCTATCTTATACAGCGGAGCGGTGATGCTATCTTGTTAGTTACAGTTTGATTGATGCTATCTTATTGCCTCGGCGGATACAGTTTGATGCTATCTTTGAGGTCTTGTGATGCTATCTTGATGCTATCTTTGATGCTGATGCTTGATGCTATCTTGATGCTATCTTTCGATTGAGGTAGGTAAACTGATGTGATGCTATCTTGATGCTATGATGCTATCTTCTATCTTCGACTGATGCTATCTTGATGCTATCTTACGACTTTGAGGTCTTGATGATGCTATCTTGATGCTATCTTACGGTAAACCGACCAAGGTAAACCGACGAATTGTGGACGCACCTAGAAGGTAAACCGACGCAAAGGTAAATGATGCTTGATGCTATCTTTAAGGTAAACCGAAGGTAAACCGACCGATGATGCTATCTTAAACCGACAAACCGACCTAAGGTAAACCGACTTGACCCGCACCTGATGCTATCTTTTGAGGTAGGTAATGATGCTATCTTTCTTAGGTCTGATGCTATCTTATCTTTAGGTAAACCGACCTGATGCTATCTTTTTTAGGTAAACCGACGTAAACAGGTAAACCGACGTCTTTGAGGTCTTGAAATTCCTTTGAGGTCTTGAGGTAAACCGACGGTCTTGACATTGTGCTTGTTGAGGTCTTGAGAGGTAAAGGTAAACCGACGGTAAACCGACACTGTCATAAACGTATGAATTGAACGGGCACCTAGAATTCAAGCTCCCTCTCCTCGGTGCAGCACCTAGAAGCACCTAGAATTCTTGCCCCGGCAAGAAATATAGGGAGGTTCCGTGCACCTAGAATTCCGCCGACAGAGTCATTCCGCACCTAGAATTACCTAGAATTAAGCACCTAGAATTAGCCTGGCGACAAGGCCACGGCCAATTATTGTCCACCGGACCCCGCACTGTTCTTATAGCTGACAGGAAAACCTTTGTGCAGAAAGATGAATATACTGGAAGTCAAAACACTGTGCATCCCGTACTGAGCGTGCCGTTGTGTTACCTATAGGATAAAATTTTCGCATGCGCTTCACAGTCTCACAAACACTGAGTAGAGGTAGCGTGCGATTCGAAATTTCTTTACTGGTGTCAAAGGTTGAAACGACAGCTACCGGATCTTTATCTAGAGTAATCTGGGACCCTACCTCAACCTTTTGTTCATTGCCGTCGGTAAAGGCGAATAGTCTAGGAATGTGTTGGATCAGGGCGTTGGTTGACAAGGGTATCTATCCAACGCGACATTGTTACATCTATGCTGTATGATATGCGCCCCCACCGGCACGAACCCCTACTCGTACACCAACTGCCCAAATGCAGCGAATATATCATATGGGTGATGGGTCGGACGGCATGACATAATAACGGGTTGATGTAGCGAATATATCGGAGCCACAGCGAATATATCATCCTAGCGAATATATCGCGAATAGCGAATATATCGCGAATAAGCGAATATATCTTGAACTAGCGAATATATCGAATATATCCTCAAGCTGGCCCCATCTCGAATAAGCGAATATATCCGAATATATTGGCCCCATCTCCCATCTCGTGGCCCCATCTCATGGCCCCATCTCTCTCTATCCGTATAGCGATGTCCCGTCCCATGTTAGACGAAGCGAATATATCTCAATATATCACCCGGTCCGCTGTTAGGTACTGGGTAAAGAAGCGAGCGTGGCCCCATCTCATCTCATATTGGCCCCATCTCTGGCCCCATCTCCATGGCCCCATCTCAGGGTAAATGCGTAGCGATTGGCCCCATCTCGAAGCGAATATATCTGCTTGTAAATACTCAGTAGCGAATATTGGCCCCATCTCTCCCTATCGAAGCGAATGGCCCCATCTCCATGGCCCCATCTCTACCTCAATGGCCCCATCTCTCTCAAATTTTGGCCCCATCTCTTTTCCTGGCCCCATCTCACTTTGGCCCCATCTCCCATCTCCCCCATCTCTCCCTTACTTTGGCCCCATCTCCCATCTCCCTATGGCCCTGGCCCCATCTCCTTTTCCCTGGGGTGGCTGGCCCCATCTCTCGGTTGGCCCCATCTCTACTTTTCCCTCGTTACTGTAGCTGGGTACTTTGCTGGGTTACTTTTCCCTCTCCCGTCCAGTATTTACTTTTCCCTTGATTACTTTTCCCTTACTTTTCCCTTCCCTTGGCTTTACTTTTCCCTTTTACTTTACTTTTCCCTCTTATTACTTTTCCCTGAATGGCCACTCTCCTCTGGGACCCATTACTTTTCCCTGAGTTACTTTTCCCTTAAGCGTATTACTTTTCCCTTTTTTTAACGATCTTACTTTTCCCTAACCAAACAAAGCATTTGTAATTCTATTAAGGCGGCAACGAATTACTTTTCCCTATTACTTTTCCCTAGGCACAAACTCTTACTTTTCCCTGTGGCTTTTAGCAGTATGTGACCTACGCGCTTAACCGGCAGATCATACGCAATCAGACCTCTTAGAAGCTTGGGAAAGGGTGCAGAAAGCGCCTCTCTTAGAAAACTGACGAATCATCGACACAGTCGGAGCGGACCGCTCCTGTTCTGCACAGCATACTAAATAAGGATACAGGTGAAAAGCCACAGTTATCACAATACAGTCCGTAGGCCGCTCTCGCGACCACCCTAATTGGCAGAAAGGGAATCTTGCAAGAAGATTTGATCCGAGCACACGATTCGGGGCATGTTAAAAGCCAAACTCGGGTATATATTCATATGGGAGACCTTAATGGTCAGTACGTGCAGAACTTCTCCGCGCGAGATCTCTGGGTGTAAATTCTCTTGTTGCAAGTAAAGGCTCGGTTTACTGAGGCGCTCTGCTACGTATCACTTTAAAGAACAAATTCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCCAGTCATTACCCAGTCATTACCCCCAGTCATTACCCCAGTCATTACCC");
        System.out.println(LocalDateTime.now());
        Set<Sequence> clump = genome.clumpFinding(12, 582, 18);
        System.out.println(LocalDateTime.now());
        System.out.println(clump.size());
        System.out.println(clump.stream().map(s->s.toString()).collect(Collectors.joining(" ")));
    }

}
